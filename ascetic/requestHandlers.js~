var fs = require('fs');
var textutils = require('./textutils');

var exec = require("child_process").exec;

function start(response) {
    console.log("Request handler 'start' was called.");

    exec("ls -lah", function (error, stdout, stderr) {
	response.writeHead(200, {"Content-Type": "text/plain"});
	response.write(stdout);
	response.end();
    });
}

function upload(response) {
    console.log("Request handler 'upload' was called.");
    data = {title: 'Login'};
    result = render('views/testrender.html', response, data);

//    response.write("result");

}


function render(page, response, data) {
    fs.readFile(page, 'utf-8', function(err, template) {
	if (err) throw err;

	replacementJSON = {'title': 'Logon'};
	output = textutils.getModifiedText(template, replacementJSON);
	response.writeHead(200, {"Content-Type": "text/html"});

	response.write(output);
	response.end();
	//console.log(data);
	return data;
    });
}

exports.start = start;
exports.upload = upload;